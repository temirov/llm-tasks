# YAML refactor of changelog task settings (no XML anywhere).
# Inputs: version/date are required; git_log is read from stdin.
task: changelog

llm:
  model: gpt-5-mini
  temperature: 1
  max_tokens: 1200

inputs:
  version:
    required: true
    env: CHANGELOG_VERSION
    default: ""
  date:
    required: true
    env: CHANGELOG_DATE
    default: ""
  git_log:
    required: true
    source: stdin

recipe:
  system: |
    Do not invent items. Group under: Highlights, Features ✨, Improvements ⚙️, Docs 📚, CI & Maintenance, and an Upgrade notes line. Keep bullets concise, include PR numbers and SHAs if present. Output valid Markdown only.
  format:
    heading: "## [${version}] - ${date}"
    sections:
      - title: "Highlights"
        min: 1
        max: 3
      - title: "Features ✨"
      - title: "Improvements ⚙️"
      - title: "Docs 📚"
      - title: "CI & Maintenance"
    footer: "**Upgrade notes:** No breaking changes."
  rules:
    - "Only use information present in the git log."
    - "Preserve PR numbers and short SHAs in parentheses if present."
    - "Prefer user-facing value in Highlights; keep 1–3 bullets."
    - "No placeholders, no commentary, no extra prose."

apply:
  output_path: "./CHANGELOG.md"
  mode: "prepend"           # prepend | print
  ensure_blank_line: true
